<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>content</title>
	<style type="text/css">
	div{height: 510px;margin: 0 20px;position: relative;}
	span{display: inline-block;margin: 5px;width:10px;position: absolute;bottom: 0;}
	</style>
</head>
<body>
	<form id="form">
	<input type="text" id="ipt" >
	<button id="leftin" type="button">左侧入</button>
	<button id="rightin" type="button">右侧入</button>
	<button id="leftout" type="button">左侧出</button>
	<button id="rightout" type="button">右侧出</button>
	<button type="button" id="random" >随机50个</button>
	<button type="button" id="osort">冒泡排序</button>
	</form>
	<div id="div">
	</div>
	<script type="text/javascript">
	// 进入函数
	var $=function(o){return document.getElementById(o)};
	var leftin=$("leftin"),
		leftout=$("leftout"),
		rightin=$("rightin"),
		rightout=$("rightout"),
		div=$("div"),
		arr=[],
		ipt=$("ipt"),
		orandom=$("random"),
		osort=$("osort"),
		timer=null,
		snapshots=[];
	function arrin(){
		if(this.id=="leftin"){
			parseInt(ipt.value)>10&&parseInt(ipt.value)<100?arr.unshift(parseInt(ipt.value)):alert("请输入10-100数字");
		}else if(this.id=="rightin"){
			parseInt(ipt.value)>10&&parseInt(ipt.value)<100?arr.push(parseInt(ipt.value)):alert("请输入10-100数字");
		}
		ipt.value="";
		render();
		// var all=[].slice.call(div.childNodes,0);
		// for(var i=0;i<all.length;i++){
		// 	all[i].onclick=binddel;
		// }
	}
	function arrout(){
		if(this.id=="leftout"){
			arr.shift();
		}else if(this.id=="rightout"){
			arr.pop();
		}
		render();
	}
	function render(fun){
		arr=fun||arr;
		div.innerHTML="";
		for(var i=0;i<arr.length;i++){
			var oitem=document.createElement("span");
			oitem.style.height=arr[i]*5+"px";
			oitem.style.left=i*15+"px";
			oitem.style.backgroundColor="rgba(110"+","+i*5+","+i*10+",1)";
			div.appendChild(oitem);
		}
		var all=[].slice.call(div.childNodes,0);
		for(var i=0;i<all.length;i++){
			all[i].onclick=binddel;
		}
	}
	function binddel(event){
		event=event||window.event;
		event.target.parentNode.removeChild(event.target);
		arr.splice(arr.indexOf(parseInt(event.target.style.height)/5),1);
		render();
	}
	osort.onclick = function() {
     if (arr.length == 0) return alert("队列为空");
     bubbleSort(arr);
     timer = setInterval(paint, 10); //定时绘制
     function paint() {
         var snapshot = snapshots.shift() || [];
         if (snapshot.length !== 0) {
             render(snapshot);
         } else {
             clearInterval(timer); //绘制结束
             // div.innerHTML="";
             return;
         }
     }
 }
	function bubbleSort(arr) {
     snapshots = [];
     if (arr.length < 1) {
         return arr;
     }
     var temp;
     for (var i = 0; i < arr.length; i++) {
         for (var j = 0; j < arr.length - i - 1; j++) {
             if (arr[j] > arr[j + 1]) {
                 temp = arr[j + 1];
                 arr[j + 1] = arr[j];
                 arr[j] = temp;
                 snapshots.push(JSON.parse(JSON.stringify(arr))); // 记录快照
             }
         }
     }
     return arr;
 }
 	function myrandom(){
		arr=[];
		for(var i=0;i<50;i++){
		var num=Math.floor(Math.random()*90)+10;
		arr.push(num);
		}
		render();
		// dd++;
		// if(dd<50){
		//  setTimeout(myrandom, 100);	
		// }
	}

	leftin.onclick=arrin;
	leftout.onclick=arrout;
	rightin.onclick=arrin;
	rightout.onclick=arrout;
	var dd=0;
	orandom.onclick=myrandom;
	</script>
</body>
</html>							